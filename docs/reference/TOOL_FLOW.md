# Suna-Lite å·¥å…·è°ƒç”¨æµç¨‹æ–‡æ¡£

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜ Suna-Lite ç³»ç»Ÿä¸­å·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬ç³»ç»Ÿæ¶æ„ã€å·¥å…·ç»§æ‰¿å…³ç³»ã€å…·ä½“æ“ä½œæµç¨‹ç­‰ã€‚

## ç›®å½•

1. [ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ](#ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ)
2. [ä¸»è¦å·¥å…·è°ƒç”¨æµç¨‹](#ä¸»è¦å·¥å…·è°ƒç”¨æµç¨‹)
3. [å·¥å…·ç»§æ‰¿å…³ç³»](#å·¥å…·ç»§æ‰¿å…³ç³»)
4. [å…·ä½“å·¥å…·æ“ä½œæµç¨‹](#å…·ä½“å·¥å…·æ“ä½œæµç¨‹)
5. [å…³é”®æŠ€æœ¯ç‰¹ç‚¹](#å…³é”®æŠ€æœ¯ç‰¹ç‚¹)
6. [å®‰å…¨æœºåˆ¶](#å®‰å…¨æœºåˆ¶)

## ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ

Suna-Lite é‡‡ç”¨å››å±‚æ¶æ„è®¾è®¡ï¼Œç¡®ä¿ç³»ç»Ÿçš„æ¨¡å—åŒ–ã€å®‰å…¨æ€§å’Œå¯æ‰©å±•æ€§ã€‚

### æ¶æ„å›¾

**Suna-Lite å®Œæ•´ç³»ç»Ÿæ¶æ„å›¾**
```
Suna-Lite ç³»ç»Ÿæ¶æ„
    â”‚
    â”œâ”€â”€ ç”¨æˆ·ç•Œé¢å±‚
    â”‚   â””â”€â”€ Rich CLI ç•Œé¢
    â”‚
    â”œâ”€â”€ Agent æ ¸å¿ƒå±‚
    â”‚   â”œâ”€â”€ SunaAgent ä¸»ç±»
    â”‚   â”œâ”€â”€ å¯¹è¯ç®¡ç†
    â”‚   â”œâ”€â”€ å·¥å…·ç®¡ç†
    â”‚   â”œâ”€â”€ å·¥ä½œåŒºç®¡ç†
    â”‚   â””â”€â”€ é…ç½®ç®¡ç†
    â”‚
    â”œâ”€â”€ å·¥å…·å±‚
    â”‚   â”œâ”€â”€ ToolRegistry
    â”‚   â”œâ”€â”€ BaseTool åŸºç±»
    â”‚   â”œâ”€â”€ FileTool
    â”‚   â”œâ”€â”€ ShellTool
    â”‚   â”œâ”€â”€ WebTool
    â”‚   â”œâ”€â”€ TavilyTool
    â”‚   â””â”€â”€ BrowserTool
    â”‚
    â”œâ”€â”€ å¤–éƒ¨æœåŠ¡å±‚
    â”‚   â”œâ”€â”€ OpenAI API
    â”‚   â”œâ”€â”€ Tavily API
    â”‚   â”œâ”€â”€ æ–‡ä»¶ç³»ç»Ÿ
    â”‚   â”œâ”€â”€ æ“ä½œç³»ç»Ÿ
    â”‚   â””â”€â”€ Web æµè§ˆå™¨
    â”‚
    â””â”€â”€ æ”¯æ’‘æœåŠ¡å±‚
        â”œâ”€â”€ WorkspaceManager
        â”œâ”€â”€ Settings é…ç½®
        â”œâ”€â”€ Logger æ—¥å¿—
        â””â”€â”€ å®‰å…¨æœºåˆ¶
```

### æ¶æ„å±‚æ¬¡

#### 1. ç”¨æˆ·ç•Œé¢å±‚
- **Rich CLI ç•Œé¢**ï¼šæä¾›ç¾è§‚çš„å‘½ä»¤è¡Œäº¤äº’ç•Œé¢
- æ”¯æŒå½©è‰²è¾“å‡ºã€è¿›åº¦æ˜¾ç¤ºã€æ ¼å¼åŒ–è¡¨æ ¼
- æä¾›å‹å¥½çš„ç”¨æˆ·äº¤äº’ä½“éªŒ

#### 2. Agent æ ¸å¿ƒå±‚
- **SunaAgent ä¸»ç±»**ï¼šç³»ç»Ÿçš„æ ¸å¿ƒæ§åˆ¶å•å…ƒ
- **å¯¹è¯ç®¡ç†**ï¼šç»´æŠ¤å¯¹è¯å†å²å’Œä¸Šä¸‹æ–‡
- **å·¥å…·ç®¡ç†**ï¼šå·¥å…·æ³¨å†Œã€è°ƒç”¨å’ŒçŠ¶æ€ç®¡ç†
- **å·¥ä½œåŒºç®¡ç†**ï¼šéš”ç¦»çš„æ–‡ä»¶æ“ä½œç¯å¢ƒ
- **é…ç½®ç®¡ç†**ï¼šç³»ç»Ÿé…ç½®å’Œå‚æ•°ç®¡ç†

#### 3. å·¥å…·å±‚
- **ToolRegistry**ï¼šå·¥å…·æ³¨å†Œè¡¨ï¼Œç®¡ç†æ‰€æœ‰å¯ç”¨å·¥å…·
- **BaseTool**ï¼šæŠ½è±¡åŸºç±»ï¼Œå®šä¹‰ç»Ÿä¸€æ¥å£
- **å…·ä½“å·¥å…·**ï¼šFileToolã€ShellToolã€WebToolã€TavilyToolã€BrowserTool

#### 4. å¤–éƒ¨æœåŠ¡å±‚
- **OpenAI API**ï¼šAIæ¨¡å‹æœåŠ¡
- **Tavily API**ï¼šç½‘ç»œæœç´¢æœåŠ¡
- **æ–‡ä»¶ç³»ç»Ÿ**ï¼šæœ¬åœ°æ–‡ä»¶æ“ä½œ
- **æ“ä½œç³»ç»Ÿ**ï¼šç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ
- **Web æµè§ˆå™¨**ï¼šæµè§ˆå™¨è‡ªåŠ¨åŒ–

## ä¸»è¦å·¥å…·è°ƒç”¨æµç¨‹

### å®Œæ•´è°ƒç”¨æµç¨‹å›¾

```
Suna-Lite å·¥å…·è°ƒç”¨å®Œæ•´æµç¨‹å›¾
ç”¨æˆ·è¾“å…¥
    â†“
SunaAgent.process_message()
    â†“
æ„å»ºå¯¹è¯ä¸Šä¸‹æ–‡ (messages + tool_schemas)
    â†“
è°ƒç”¨ OpenAI API (LLMå†³ç­–)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           LLMå†³ç­–                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  éœ€è¦å·¥å…·è°ƒç”¨?    â”‚  ç›´æ¥è¿”å›å“åº”     â”‚
â”‚      â†“           â”‚      â†“          â”‚
â”‚  æ‰§è¡Œå·¥å…·è°ƒç”¨     â”‚  è¿”å›ç»™ç”¨æˆ·      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è§£æå·¥å…·è°ƒç”¨å‚æ•° (function_name, arguments)
    â†“
ToolRegistry.execute_tool()
    â†“
BaseTool.safe_execute() [å®‰å…¨æ‰§è¡Œ]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å®‰å…¨æ£€æŸ¥                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å‚æ•°éªŒè¯ â†’ å·¥å…·å¯ç”¨æ€§ â†’ è·¯å¾„å®‰å…¨     â”‚
â”‚      â†“           â†“          â†“       â”‚
â”‚  å¤±è´¥è¿”å›      å¤±è´¥è¿”å›    å¤±è´¥è¿”å›   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å…·ä½“å·¥å…·.execute() [å®é™…æ‰§è¡Œ]
    â†“
è¿”å› ToolResponse
    â†“
æ ¼å¼åŒ–å·¥å…·ç»“æœ
    â†“
å‘é€å› LLM è¿›è¡Œæœ€ç»ˆå¤„ç†
    â†“
è¿”å›æœ€ç»ˆå“åº”ç»™ç”¨æˆ·
```

### æµç¨‹æ­¥éª¤è¯¦è§£

#### æ­¥éª¤ 1ï¼šç”¨æˆ·è¾“å…¥å¤„ç†
```python
# ç”¨æˆ·å‘é€æ¶ˆæ¯
ç”¨æˆ·è¾“å…¥: "åˆ›å»ºä¸€ä¸ªåä¸ºhello.txtçš„æ–‡ä»¶ï¼Œå†…å®¹ä¸º'Hello World!'"

# SunaAgent æ¥æ”¶å¹¶å¤„ç†æ¶ˆæ¯
result = await agent.process_message(message, conversation_history)
```

#### æ­¥éª¤ 2ï¼šæ„å»ºå¯¹è¯ä¸Šä¸‹æ–‡
```python
# æ„å»ºåŒ…å«å¯¹è¯å†å²çš„æ¶ˆæ¯åˆ—è¡¨
messages = agent._build_conversation_context(message, conversation_history)

# è·å–å¯ç”¨å·¥å…·çš„ Schema
tool_schemas = agent.tool_registry.get_tool_schemas()
```

#### æ­¥éª¤ 3ï¼šLLM è°ƒç”¨å’Œå†³ç­–
```python
# è°ƒç”¨ OpenAI API
response = await agent._call_llm(messages, tool_schemas)

# LLM å†³å®šæ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·
if response.get('tool_calls'):
    # éœ€è¦å·¥å…·è°ƒç”¨
    return await agent._handle_tool_calls(response['tool_calls'])
else:
    # ç›´æ¥è¿”å› LLM å“åº”
    return response['choices'][0]['message']['content']
```

#### æ­¥éª¤ 4ï¼šå·¥å…·è°ƒç”¨æ‰§è¡Œ
```python
# è§£æå·¥å…·è°ƒç”¨å‚æ•°
for tool_call in response['tool_calls']:
    function_name = tool_call['function']['name']
    arguments = json.loads(tool_call['function']['arguments'])
    
    # æ‰§è¡Œå·¥å…·
    tool_response = await agent.tool_registry.execute_tool(
        function_name, **arguments
    )
    
    results.append({
        'tool_call_id': tool_call['id'],
        'name': function_name,
        'response': tool_response.to_dict()
    })
```

#### æ­¥éª¤ 5ï¼šç»“æœæ ¼å¼åŒ–å’Œè¿”å›
```python
# æ ¼å¼åŒ–å·¥å…·æ‰§è¡Œç»“æœ
response_content = agent._format_tool_results(results)

# å°†å·¥å…·ç»“æœå‘é€å› LLM è¿›è¡Œæœ€ç»ˆå¤„ç†
final_response = await agent._call_llm_with_tool_results(
    messages, results, response_content
)
```

## å·¥å…·ç»§æ‰¿å…³ç³»

### ç»§æ‰¿å…³ç³»å›¾

```
Suna-Lite å·¥å…·ç»§æ‰¿å…³ç³»å›¾
BaseTool (æŠ½è±¡åŸºç±»)
â”œâ”€â”€ execute() (æŠ½è±¡æ–¹æ³•)
â”œâ”€â”€ get_schema() (æŠ½è±¡æ–¹æ³•)
â”œâ”€â”€ validate_params()
â”œâ”€â”€ is_available()
â””â”€â”€ safe_execute()
    â”‚
    â”œâ”€â”€ FileTool (æ–‡ä»¶æ“ä½œå·¥å…·)
    â”‚   â”œâ”€â”€ read_file()
    â”‚   â”œâ”€â”€ write_file()
    â”‚   â”œâ”€â”€ list_directory()
    â”‚   â”œâ”€â”€ delete_file()
    â”‚   â””â”€â”€ search_files()
    â”‚
    â”œâ”€â”€ ShellTool (å‘½ä»¤æ‰§è¡Œå·¥å…·)
    â”‚   â”œâ”€â”€ execute_command()
    â”‚   â”œâ”€â”€ check_safety()
    â”‚   â”œâ”€â”€ filter_dangerous()
    â”‚   â””â”€â”€ capture_output()
    â”‚
    â”œâ”€â”€ WebTool (ç½‘ç»œæœç´¢å·¥å…·)
    â”‚   â”œâ”€â”€ fetch_content()
    â”‚   â”œâ”€â”€ parse_html()
    â”‚   â”œâ”€â”€ extract_links()
    â”‚   â””â”€â”€ search_web()
    â”‚
    â”œâ”€â”€ TavilyTool (Tavilyæœç´¢å·¥å…·)
    â”‚   â”œâ”€â”€ search()
    â”‚   â”œâ”€â”€ qna()
    â”‚   â”œâ”€â”€ context()
    â”‚   â”œâ”€â”€ extract()
    â”‚   â”œâ”€â”€ crawl()
    â”‚   â””â”€â”€ map()
    â”‚
    â””â”€â”€ BrowserTool (æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·)
        â”œâ”€â”€ navigate()
        â”œâ”€â”€ click_element()
        â”œâ”€â”€ fill_form()
        â”œâ”€â”€ extract_data()
        â””â”€â”€ screenshot()
```

### BaseTool æŠ½è±¡åŸºç±»

æ‰€æœ‰å·¥å…·éƒ½ç»§æ‰¿è‡ª `BaseTool` åŸºç±»ï¼Œç¡®ä¿ç»Ÿä¸€çš„æ¥å£å’Œè¡Œä¸ºã€‚

#### æ ¸å¿ƒæ–¹æ³•
```python
class BaseTool(ABC):
    @abstractmethod
    async def execute(self, **kwargs) -> ToolResponse:
        """æ‰§è¡Œå·¥å…·çš„ä¸»è¦é€»è¾‘"""
        pass
    
    @abstractmethod
    def get_schema(self) -> Dict[str, Any]:
        """è¿”å›å·¥å…·çš„ JSON Schema"""
        pass
    
    def validate_params(self, params: Dict[str, Any]) -> bool:
        """éªŒè¯å‚æ•°çš„æœ‰æ•ˆæ€§"""
        pass
    
    def is_available(self) -> bool:
        """æ£€æŸ¥å·¥å…·æ˜¯å¦å¯ç”¨"""
        pass
    
    async def safe_execute(self, **kwargs) -> ToolResponse:
        """å®‰å…¨æ‰§è¡Œå·¥å…·ï¼ŒåŒ…å«é”™è¯¯å¤„ç†"""
        try:
            # å‚æ•°éªŒè¯
            if not self.validate_params(kwargs):
                return ToolResponse(
                    success=False,
                    message="å‚æ•°éªŒè¯å¤±è´¥",
                    error="Invalid parameters"
                )
            
            # æ£€æŸ¥å¯ç”¨æ€§
            if not self.is_available():
                return ToolResponse(
                    success=False,
                    message="å·¥å…·ä¸å¯ç”¨",
                    error="Tool not available"
                )
            
            # æ‰§è¡Œå·¥å…·é€»è¾‘
            return await self.execute(**kwargs)
            
        except Exception as e:
            return ToolResponse(
                success=False,
                message=f"å·¥å…·æ‰§è¡Œå¤±è´¥: {str(e)}",
                error=str(e)
            )
```

#### ç»Ÿä¸€å“åº”æ ¼å¼
```python
@dataclass
class ToolResponse:
    success: bool      # æ‰§è¡Œæ˜¯å¦æˆåŠŸ
    message: str      # å“åº”æ¶ˆæ¯
    data: Any = None  # å“åº”æ•°æ®
    error: str = None # é”™è¯¯ä¿¡æ¯
```

## å…·ä½“å·¥å…·æ“ä½œæµç¨‹

### 1. FileTool (æ–‡ä»¶æ“ä½œå·¥å…·)

#### æµç¨‹å›¾

```
FileTool è¯¦ç»†æ“ä½œæµç¨‹
ç”¨æˆ·è¯·æ±‚æ–‡ä»¶æ“ä½œ
    â†“
FileTool.execute()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         è·¯å¾„å®‰å…¨æ£€æŸ¥                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. æ£€æŸ¥è·¯å¾„æ˜¯å¦å®‰å…¨ (../æ”»å‡»)       â”‚
â”‚ 2. éªŒè¯æ˜¯å¦åœ¨å·¥ä½œåŒºèŒƒå›´å†…           â”‚
â”‚      â†“           â†“                 â”‚
â”‚  ä¸å®‰å…¨è·¯å¾„      å®‰å…¨è·¯å¾„           â”‚
â”‚      â†“           â†“                 â”‚
â”‚  è¿”å›é”™è¯¯       ç»§ç»­æ‰§è¡Œ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ–‡ä»¶æ“ä½œæ‰§è¡Œ                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ operation ç±»å‹åˆ¤æ–­                  â”‚
â”‚ â†“           â†“           â†“           â”‚
â”‚ read      write      delete        â”‚
â”‚ â†“           â†“           â†“           â”‚
â”‚ è¯»å–æ–‡ä»¶   å†™å…¥æ–‡ä»¶   åˆ é™¤æ–‡ä»¶       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¿”å› ToolResponse
    â†“
è®°å½•æ“ä½œæ—¥å¿—
    â†“
å®Œæˆ
```

#### æ ¸å¿ƒåŠŸèƒ½
- **æ–‡ä»¶æ“ä½œ**ï¼šè¯»å–ã€å†™å…¥ã€åˆ›å»ºã€åˆ é™¤
- **ç›®å½•æ“ä½œ**ï¼šåˆ—è¡¨ã€åˆ›å»ºã€åˆ é™¤
- **æ–‡ä»¶ç®¡ç†**ï¼šå¤åˆ¶ã€ç§»åŠ¨ã€æœç´¢
- **ä¿¡æ¯è·å–**ï¼šæ–‡ä»¶å¤§å°ã€ä¿®æ”¹æ—¶é—´ç­‰

#### å®‰å…¨æœºåˆ¶
```python
async def execute(self, **kwargs) -> ToolResponse:
    # 1. è·¯å¾„å®‰å…¨æ£€æŸ¥
    file_path = kwargs.get('path', '')
    if not self._is_safe_path(file_path):
        return ToolResponse(
            success=False,
            message="è·¯å¾„ä¸å®‰å…¨",
            error="Unsafe path detected"
        )
    
    # 2. éªŒè¯å·¥ä½œåŒºèŒƒå›´
    if not self._is_within_workspace(file_path):
        return ToolResponse(
            success=False,
            message="è¶…å‡ºå·¥ä½œåŒºèŒƒå›´",
            error="Path outside workspace"
        )
    
    # 3. æ‰§è¡Œæ–‡ä»¶æ“ä½œ
    operation = kwargs.get('operation', 'read')
    if operation == 'read':
        return await self._read_file(file_path)
    elif operation == 'write':
        return await self._write_file(file_path, kwargs.get('content', ''))
    # ... å…¶ä»–æ“ä½œ
```

### 2. ShellTool (å‘½ä»¤æ‰§è¡Œå·¥å…·)

#### æµç¨‹å›¾

```
ShellTool è¯¦ç»†æ“ä½œæµç¨‹
ç”¨æˆ·è¯·æ±‚æ‰§è¡Œå‘½ä»¤
    â†“
ShellTool.execute()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å‘½ä»¤å®‰å…¨æ£€æŸ¥                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. å±é™©å‘½ä»¤é»‘åå•è¿‡æ»¤               â”‚
â”‚ 2. å‘½ä»¤æ³¨å…¥æ£€æµ‹                     â”‚
â”‚ 3. å·¥ä½œç›®å½•éªŒè¯                     â”‚
â”‚      â†“           â†“          â†“      â”‚
â”‚  å±é™©å‘½ä»¤     æ³¨å…¥æ”»å‡»    ä¸å®‰å…¨ç›®å½•  â”‚
â”‚      â†“           â†“          â†“      â”‚
â”‚  è¿”å›é”™è¯¯     è¿”å›é”™è¯¯    è¿”å›é”™è¯¯   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å‘½ä»¤æ‰§è¡Œ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. åˆ›å»ºå­è¿›ç¨‹                       â”‚
â”‚ 2. è®¾ç½®è¶…æ—¶æ§åˆ¶                     â”‚
â”‚ 3. æ•è·æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯               â”‚
â”‚ 4. ç­‰å¾…å‘½ä»¤å®Œæˆ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç»“æœå¤„ç†                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è§£æè¾“å‡ºå†…å®¹                        â”‚
â”‚ æ ¼å¼åŒ–æ‰§è¡Œç»“æœ                      â”‚
â”‚ è®°å½•æ‰§è¡Œæ—¥å¿—                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¿”å› ToolResponse
    â†“
å®Œæˆ
```

#### æ ¸å¿ƒåŠŸèƒ½
- **å‘½ä»¤æ‰§è¡Œ**ï¼šå®‰å…¨æ‰§è¡Œç³»ç»Ÿå‘½ä»¤
- **è·¨å¹³å°æ”¯æŒ**ï¼šWindowsã€Linuxã€macOS
- **è¾“å‡ºæ•è·**ï¼šæ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡º
- **è¶…æ—¶æ§åˆ¶**ï¼šé˜²æ­¢é•¿æ—¶é—´è¿è¡Œçš„å‘½ä»¤

#### å®‰å…¨æœºåˆ¶
```python
async def execute(self, **kwargs) -> ToolResponse:
    command = kwargs.get('command', '')
    
    # 1. å±é™©å‘½ä»¤é»‘åå•è¿‡æ»¤
    if self._is_dangerous_command(command):
        return ToolResponse(
            success=False,
            message="å‘½ä»¤è¢«å®‰å…¨ç­–ç•¥é˜»æ­¢",
            error="Dangerous command detected"
        )
    
    # 2. å‘½ä»¤æ³¨å…¥æ£€æµ‹
    if self._has_command_injection(command):
        return ToolResponse(
            success=False,
            message="æ£€æµ‹åˆ°å‘½ä»¤æ³¨å…¥å°è¯•",
            error="Command injection detected"
        )
    
    # 3. å·¥ä½œåŒºè·¯å¾„éªŒè¯
    if not self._is_safe_working_directory():
        return ToolResponse(
            success=False,
            message="å·¥ä½œç›®å½•ä¸å®‰å…¨",
            error="Unsafe working directory"
        )
    
    # 4. å¼‚æ­¥æ‰§è¡Œå‘½ä»¤
    return await self._execute_command_safely(command)
```

#### å±é™©å‘½ä»¤é»‘åå•
```python
DANGEROUS_COMMANDS = [
    'rm -rf', 'format', 'del', 'shutdown',
    'reboot', 'halt', 'poweroff',
    'chmod 777', 'chown', 'passwd',
    'su', 'sudo', 'dd', 'mkfs'
]
```

### 3. WebTool / TavilyTool (ç½‘ç»œæœç´¢å·¥å…·)

#### æµç¨‹å›¾

```
WebTool/TavilyTool æ“ä½œæµç¨‹
ç”¨æˆ·è¯·æ±‚ç½‘ç»œæœç´¢
    â†“
WebTool/TavilyTool.execute()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         API å¯†é’¥éªŒè¯                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ£€æŸ¥ API å¯†é’¥æ˜¯å¦æœ‰æ•ˆ                â”‚
â”‚      â†“           â†“                 â”‚
â”‚  æ— æ•ˆå¯†é’¥      æœ‰æ•ˆå¯†é’¥             â”‚
â”‚      â†“           â†“                 â”‚
â”‚  è¿”å›é”™è¯¯       ç»§ç»­æ‰§è¡Œ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æœç´¢å‚æ•°æ„å»º                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è§£ææœç´¢æŸ¥è¯¢                      â”‚
â”‚ 2. ç¡®å®šæœç´¢ç±»å‹ (search/qna/context) â”‚
â”‚ 3. è®¾ç½®æœç´¢å‚æ•°                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç½‘ç»œè¯·æ±‚æ‰§è¡Œ                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. å‘é€ HTTP è¯·æ±‚                   â”‚
â”‚ 2. è®¾ç½®è¶…æ—¶æ§åˆ¶                     â”‚
â”‚ 3. å¤„ç†ç½‘ç»œå¼‚å¸¸                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç»“æœå¤„ç†                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è§£æå“åº”æ•°æ®                      â”‚
â”‚ 2. è¿‡æ»¤æœç´¢ç»“æœ                      â”‚
â”‚ 3. æ ¼å¼åŒ–è¾“å‡ºå†…å®¹                    â”‚
â”‚ 4. è®°å½•æœç´¢æ—¥å¿—                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¿”å› ToolResponse
    â†“
å®Œæˆ
```

#### WebTool åŠŸèƒ½
- **ç½‘é¡µè·å–**ï¼šè·å–ç½‘é¡µå†…å®¹
- **å†…å®¹æå–**ï¼šæå–æ–‡æœ¬ã€é“¾æ¥ã€å›¾ç‰‡
- **é¡µé¢åˆ†æ**ï¼šåˆ†æé¡µé¢ç»“æ„

#### TavilyTool åŠŸèƒ½
- **æœç´¢åŠŸèƒ½**ï¼šsearchã€qnaã€context
- **å†…å®¹æå–**ï¼šextractã€crawl
- **ç½‘ç«™åˆ†æ**ï¼šmap

#### å®ç°ç¤ºä¾‹
```python
async def execute(self, **kwargs) -> ToolResponse:
    # 1. API å¯†é’¥éªŒè¯
    if not self._validate_api_key():
        return ToolResponse(
            success=False,
            message="API å¯†é’¥æ— æ•ˆ",
            error="Invalid API key"
        )
    
    # 2. æ„å»ºæœç´¢å‚æ•°
    query = kwargs.get('query', '')
    search_type = kwargs.get('type', 'search')
    
    # 3. å‘é€ç½‘ç»œè¯·æ±‚
    try:
        if search_type == 'search':
            results = await self._tavily_client.search(query)
        elif search_type == 'qna':
            results = await self._tavily_client.qna(query)
        # ... å…¶ä»–æœç´¢ç±»å‹
        
        # 4. ç»“æœè¿‡æ»¤å’Œæ ¼å¼åŒ–
        filtered_results = self._filter_results(results)
        return ToolResponse(
            success=True,
            message=f"æœç´¢å®Œæˆï¼Œæ‰¾åˆ° {len(filtered_results)} ä¸ªç»“æœ",
            data=filtered_results
        )
        
    except Exception as e:
        return ToolResponse(
            success=False,
            message=f"æœç´¢å¤±è´¥: {str(e)}",
            error=str(e)
        )
```

### 4. BrowserTool (æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·)

#### æµç¨‹å›¾

```
BrowserTool è¯¦ç»†æ“ä½œæµç¨‹
ç”¨æˆ·è¯·æ±‚æµè§ˆå™¨æ“ä½œ
    â†“
BrowserTool.execute()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æµè§ˆå™¨åˆå§‹åŒ–                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. åˆ›å»º WebDriver å®ä¾‹              â”‚
â”‚ 2. è®¾ç½®æµè§ˆå™¨é€‰é¡¹                   â”‚
â”‚ 3. å¯åŠ¨æµè§ˆå™¨è¿›ç¨‹                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         é¡µé¢å¯¼èˆª                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. è§£æç›®æ ‡ URL                     â”‚
â”‚ 2. å¯¼èˆªåˆ°æŒ‡å®šé¡µé¢                   â”‚
â”‚ 3. ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å…ƒç´ æ“ä½œ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ action ç±»å‹åˆ¤æ–­                     â”‚
â”‚ â†“           â†“           â†“           â”‚
â”‚ click      fill       submit        â”‚
â”‚ â†“           â†“           â†“           â”‚
â”‚ ç‚¹å‡»å…ƒç´    å¡«å†™è¡¨å•   æäº¤è¡¨å•       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç­‰å¾…æœºåˆ¶                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. ç­‰å¾…å…ƒç´ å‡ºç°                     â”‚
â”‚ 2. ç­‰å¾…é¡µé¢ç¨³å®š                     â”‚
â”‚ 3. å¤„ç†è¶…æ—¶æƒ…å†µ                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         èµ„æºæ¸…ç†                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. å…³é—­æµè§ˆå™¨                       â”‚
â”‚ 2. é‡Šæ”¾ç³»ç»Ÿèµ„æº                     â”‚
â”‚ 3. è®°å½•æ“ä½œæ—¥å¿—                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¿”å› ToolResponse
    â†“
å®Œæˆ
```

#### æ ¸å¿ƒåŠŸèƒ½
- **é¡µé¢å¯¼èˆª**ï¼šnavigateã€backã€forward
- **å…ƒç´ æ“ä½œ**ï¼šclickã€fillã€submit
- **å†…å®¹æå–**ï¼šextract_textã€extract_links
- **é¡µé¢äº¤äº’**ï¼šscreenshotã€wait_for_element

#### å®ç°ç¤ºä¾‹
```python
async def execute(self, **kwargs) -> ToolResponse:
    driver = None
    try:
        # 1. æµè§ˆå™¨åˆå§‹åŒ–
        driver = await self._initialize_browser()
        
        # 2. é¡µé¢å¯¼èˆª
        url = kwargs.get('url', '')
        await driver.get(url)
        
        # 3. å…ƒç´ å®šä½å’Œæ“ä½œ
        action = kwargs.get('action', '')
        if action == 'click':
            element = await self._find_element(driver, kwargs.get('selector'))
            await element.click()
        elif action == 'fill':
            element = await self._find_element(driver, kwargs.get('selector'))
            await element.send_keys(kwargs.get('value', ''))
        # ... å…¶ä»–æ“ä½œ
        
        # 4. ç­‰å¾…æœºåˆ¶
        await self._wait_for_page_load(driver)
        
        return ToolResponse(
            success=True,
            message=f"æµè§ˆå™¨æ“ä½œå®Œæˆ: {action}",
            data={"action": action, "url": url}
        )
        
    except Exception as e:
        return ToolResponse(
            success=False,
            message=f"æµè§ˆå™¨æ“ä½œå¤±è´¥: {str(e)}",
            error=str(e)
        )
    finally:
        # 5. èµ„æºæ¸…ç†
        if driver:
            await driver.quit()
```

## å…³é”®æŠ€æœ¯ç‰¹ç‚¹

### 1. å¼‚æ­¥ç¼–ç¨‹æ¨¡å¼

```python
# æ‰€æœ‰å·¥å…·æ“ä½œéƒ½ä½¿ç”¨ async/await
async def execute(self, **kwargs) -> ToolResponse:
    # å¼‚æ­¥æ–‡ä»¶æ“ä½œ
    content = await self._async_read_file(file_path)
    
    # å¼‚æ­¥ç½‘ç»œè¯·æ±‚
    response = await self._async_http_request(url)
    
    # å¼‚æ­¥å‘½ä»¤æ‰§è¡Œ
    result = await self._async_execute_command(command)
    
    return ToolResponse(success=True, message="æ“ä½œå®Œæˆ", data=result)
```

### 2. å·¥å…·æ³¨å†Œç®¡ç†

```python
class ToolRegistry:
    def __init__(self):
        self.tools: Dict[str, BaseTool] = {}
    
    def register(self, tool: BaseTool):
        """æ³¨å†Œå·¥å…·"""
        self.tools[tool.name] = tool
    
    def get_available_tools(self) -> List[str]:
        """è·å–å¯ç”¨å·¥å…·åˆ—è¡¨"""
        return [name for name, tool in self.tools.items() if tool.is_available()]
    
    def get_tool_schemas(self) -> List[Dict[str, Any]]:
        """è·å–æ‰€æœ‰å·¥å…·çš„ Schema"""
        return [tool.get_schema() for tool in self.tools.values() if tool.is_available()]
    
    async def execute_tool(self, tool_name: str, **kwargs) -> ToolResponse:
        """æ‰§è¡ŒæŒ‡å®šå·¥å…·"""
        tool = self.tools.get(tool_name)
        if not tool:
            return ToolResponse(success=False, message=f"å·¥å…· {tool_name} ä¸å­˜åœ¨")
        
        return await tool.safe_execute(**kwargs)
```

### 3. é…ç½®é©±åŠ¨çš„å·¥å…·ç®¡ç†

```python
# é€šè¿‡ config.yaml æ§åˆ¶å·¥å…·å¼€å…³
tools:
  file_operations: true    # å¯ç”¨æ–‡ä»¶å·¥å…·
  shell_commands: true     # å¯ç”¨å‘½ä»¤å·¥å…·
  web_search: true         # å¯ç”¨Webæœç´¢
  browser_automation: false # ç¦ç”¨æµè§ˆå™¨å·¥å…·

# åŠ¨æ€å·¥å…·æ³¨å†Œ
if settings.tools.file_operations:
    file_tool = FileTool(workspace_manager)
    tool_registry.register(file_tool)
```

### 4. å·¥ä½œåŒºç®¡ç†

```python
class WorkspaceManager:
    def __init__(self, base_path: str):
        self.base_path = Path(base_path)
        self.session_path = self.base_path / f"session_{int(time.time())}"
    
    async def create_session_workspace(self):
        """åˆ›å»ºä¼šè¯å·¥ä½œåŒº"""
        self.session_path.mkdir(parents=True, exist_ok=True)
        
        # è®¾ç½®å·¥ä½œåŒºé™åˆ¶
        self.max_size_mb = 100
        self.auto_cleanup = True
    
    def is_safe_path(self, path: str) -> bool:
        """æ£€æŸ¥è·¯å¾„æ˜¯å¦å®‰å…¨"""
        resolved_path = Path(path).resolve()
        try:
            resolved_path.relative_to(self.session_path)
            return True
        except ValueError:
            return False
```

## å®‰å…¨æœºåˆ¶

### 1. å¤šå±‚å®‰å…¨é˜²æŠ¤

#### è·¯å¾„å®‰å…¨
- é˜²æ­¢è·¯å¾„éå†æ”»å‡» (`../` æ”»å‡»)
- é™åˆ¶æ–‡ä»¶æ“ä½œåœ¨å·¥ä½œåŒºå†…
- è·¯å¾„è§„èŒƒåŒ–å¤„ç†

#### å‘½ä»¤å®‰å…¨
- å±é™©å‘½ä»¤é»‘åå•è¿‡æ»¤
- å‘½ä»¤æ³¨å…¥æ£€æµ‹
- å·¥ä½œç›®å½•éš”ç¦»

#### ç½‘ç»œå®‰å…¨
- API å¯†é’¥éªŒè¯
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- å†…å®¹å®‰å…¨è¿‡æ»¤

### 2. è¾“å…¥éªŒè¯

```python
def validate_input(self, user_input: str) -> bool:
    """éªŒè¯ç”¨æˆ·è¾“å…¥"""
    # æ£€æŸ¥é•¿åº¦é™åˆ¶
    if len(user_input) > 10000:
        return False
    
    # æ£€æŸ¥ç‰¹æ®Šå­—ç¬¦
    dangerous_chars = ['<', '>', '&', '|', ';', '`', '$', '(', ')']
    if any(char in user_input for char in dangerous_chars):
        return False
    
    # æ£€æŸ¥ SQL æ³¨å…¥
    sql_patterns = ['SELECT', 'INSERT', 'UPDATE', 'DELETE', 'DROP']
    if any(pattern in user_input.upper() for pattern in sql_patterns):
        return False
    
    return True
```

### 3. é”™è¯¯å¤„ç†

```python
async def safe_execute_tool(self, tool_name: str, **kwargs) -> ToolResponse:
    """å®‰å…¨æ‰§è¡Œå·¥å…·"""
    try:
        # è¾“å…¥éªŒè¯
        if not self.validate_input(str(kwargs)):
            return ToolResponse(
                success=False,
                message="è¾“å…¥éªŒè¯å¤±è´¥",
                error="Input validation failed"
            )
        
        # æƒé™æ£€æŸ¥
        if not self.check_permission(tool_name):
            return ToolResponse(
                success=False,
                message="æƒé™ä¸è¶³",
                error="Insufficient permissions"
            )
        
        # æ‰§è¡Œå·¥å…·
        result = await self.tool_registry.execute_tool(tool_name, **kwargs)
        
        # è®°å½•æ—¥å¿—
        self.logger.info(f"å·¥å…· {tool_name} æ‰§è¡Œå®Œæˆ: {result.success}")
        
        return result
        
    except Exception as e:
        self.logger.error(f"å·¥å…· {tool_name} æ‰§è¡Œå¤±è´¥: {str(e)}")
        return ToolResponse(
            success=False,
            message="å·¥å…·æ‰§è¡Œå¤±è´¥",
            error=str(e)
        )
```

## æ€»ç»“

Suna-Lite çš„å·¥å…·è°ƒç”¨æµç¨‹ä½“ç°äº†ä»¥ä¸‹è®¾è®¡ç†å¿µï¼š

### ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿
1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šæ¯ä¸ªå·¥å…·éƒ½æ˜¯ç‹¬ç«‹æ¨¡å—ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
2. **ç»Ÿä¸€æ¥å£**ï¼šæ‰€æœ‰å·¥å…·ç»§æ‰¿è‡ª BaseToolï¼Œæä¾›ä¸€è‡´çš„è°ƒç”¨æ–¹å¼
3. **å®‰å…¨ä¼˜å…ˆ**ï¼šå¤šå±‚å®‰å…¨æœºåˆ¶ç¡®ä¿ç³»ç»Ÿå’Œæ•°æ®å®‰å…¨
4. **å¼‚æ­¥é«˜æ•ˆ**ï¼šå……åˆ†åˆ©ç”¨å¼‚æ­¥ç¼–ç¨‹æé«˜æ€§èƒ½
5. **é…ç½®çµæ´»**ï¼šé€šè¿‡é…ç½®æ–‡ä»¶çµæ´»æ§åˆ¶å·¥å…·åŠŸèƒ½

### ğŸ”§ æŠ€æœ¯ç‰¹ç‚¹
- **å¼‚æ­¥ç¼–ç¨‹**ï¼šæ‰€æœ‰å·¥å…·æ“ä½œä½¿ç”¨ async/await
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
- **èµ„æºç®¡ç†**ï¼šè‡ªåŠ¨æ¸…ç†å’Œèµ„æºé‡Šæ”¾
- **çŠ¶æ€ç®¡ç†**ï¼šå·¥å…·çŠ¶æ€å’Œä¼šè¯çŠ¶æ€ç®¡ç†

### ğŸ›¡ï¸ å®‰å…¨ä¿éšœ
- **è¾“å…¥éªŒè¯**ï¼šä¸¥æ ¼çš„å‚æ•°éªŒè¯å’Œæ¸…ç†
- **æƒé™æ§åˆ¶**ï¼šåŸºäºé…ç½®çš„æƒé™ç®¡ç†
- **æ²™ç®±ç¯å¢ƒ**ï¼šéš”ç¦»çš„å·¥ä½œåŒºæ‰§è¡Œç¯å¢ƒ
- **å®¡è®¡æ—¥å¿—**ï¼šå®Œæ•´çš„æ“ä½œæ—¥å¿—è®°å½•

è¿™å¥—å·¥å…·è°ƒç”¨æµç¨‹è®¾è®¡ä½¿å¾— Suna-Lite èƒ½å¤Ÿå®‰å…¨ã€é«˜æ•ˆåœ°å¤„ç†å„ç§ç”¨æˆ·è¯·æ±‚ï¼ŒåŒæ—¶ä¿æŒè‰¯å¥½çš„å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

---

*æœ¬æ–‡æ¡£æœ€åæ›´æ–°æ—¶é—´ï¼š2025-01-07*