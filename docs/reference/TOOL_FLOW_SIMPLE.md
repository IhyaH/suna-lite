# Suna-Lite 工具调用流程 - 简化版

## 1. 整体工作流程（一句话解释）

**用户说话 → 电脑理解 → 决定是否需要工具 → 使用工具 → 返回结果**

### 详细步骤：
1. **用户输入**：您说要做什么（比如"创建一个文件"）
2. **AI理解**：Suna-Agent理解您的需求
3. **工具决策**：AI决定是否需要使用工具
4. **工具执行**：如果需要，就调用相应的工具
5. **返回结果**：把工具执行的结果告诉您

## 2. 工具继承关系（简单理解）

```
BaseTool (工具老祖宗)
    ↓
├── FileTool (文件工具) - 负责读写文件
├── ShellTool (命令工具) - 负责执行系统命令  
├── WebTool (网络工具) - 负责上网搜索
├── TavilyTool (搜索工具) - 负责智能搜索
└── BrowserTool (浏览器工具) - 负责操作浏览器
```

每个工具都继承了老祖宗的能力，但又各有专长。

## 3. 每个工具的工作流程

### FileTool (文件工具)
```
用户请求 → 检查路径安全 → 验证工作区 → 执行文件操作 → 返回结果
```

**安全检查**：
- 不能访问工作区外面的文件
- 不能使用危险的路径（比如 `../../../`）

### ShellTool (命令工具)
```
用户请求 → 检查命令安全 → 执行命令 → 捕获输出 → 返回结果
```

**安全检查**：
- 不能执行危险命令（比如 `rm -rf`）
- 不能命令注入攻击

### WebTool/TavilyTool (搜索工具)
```
用户请求 → 验证API密钥 → 构建搜索参数 → 发送请求 → 处理结果 → 返回结果
```

### BrowserTool (浏览器工具)
```
用户请求 → 启动浏览器 → 打开网页 → 操作元素 → 获取结果 → 关闭浏览器
```

## 4. 实际例子

### 例子1：创建文件
```
您说："帮我创建一个hello.txt文件"
↓
AI理解：需要创建文件
↓
调用FileTool
↓
FileTool检查：路径安全吗？在工作区内吗？
↓
创建文件：hello.txt
↓
返回："文件创建成功"
```

### 例子2：搜索信息
```
您说："搜索一下Python教程"
↓
AI理解：需要搜索信息
↓
调用TavilyTool
↓
TavilyTool检查：API密钥有效吗？
↓
发送搜索请求到Tavily
↓
获取搜索结果
↓
返回："找到了以下Python教程..."
```

## 5. 安全机制（为什么系统是安全的）

### 文件操作安全
- ✅ 只能在工作区内操作文件
- ✅ 不能访问系统重要文件
- ❌ 不能用 `../` 跳出工作区

### 命令执行安全
- ✅ 过滤危险命令
- ✅ 检查命令注入
- ❌ 不能执行 `rm -rf` 等危险命令

### 网络访问安全
- ✅ 验证API密钥
- ✅ 限制访问范围
- ❌ 不能访问恶意网站

## 6. 常见问题

**Q: 为什么不能删除系统文件？**
A: 因为FileTool被限制在工作区内，无法访问系统文件。

**Q: 为什么不能执行某些命令？**
A: ShellTool有黑名单机制，危险命令被过滤掉了。

**Q: 搜索结果从哪里来？**
A: 来自Tavily搜索API，不是随便从网上抓的。

## 7. 总结

Suna-Lite就像一个有工具箱的助手：
- **耳朵**：听懂您的需求
- **大脑**：决定用什么工具
- **工具箱**：文件工具、命令工具、搜索工具、浏览器工具
- **安全员**：确保每个操作都是安全的
- **嘴巴**：告诉您操作结果

这样设计既强大又安全，您可以放心使用！